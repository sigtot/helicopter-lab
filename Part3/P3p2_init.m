%% Part 3

A = [0, 1, 0; 0, 0, 0; 0, 0, 0];
B = [0, 0; 0, K_1; K_2, 0];
C = [1, 0, 0; 0, 0, 1];

q1 = 150; %4
q2 = 10; %4
q3 = 150; %14
q4 = 10; %20
q5 = 10; %200

Q_3 = diag([q1, q2, q3, q4, q5]);

r1 = 2; %1
r2 = 20; %20

R = diag([r1, r2]);

K = lqr(A_3, B_3, Q_3, R);
K_hat = K(1:2, 1:3);

Control = [A, A * B, A.^2 * B];

C_3 = [1, 0, 0, 0, 0; 0, 0, 1, 0, 0];

P = inv(C * inv(B * K_hat - A) * B);